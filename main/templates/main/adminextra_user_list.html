{% extends 'main/layout.html' %}

{% block title %}Adminextra Users{% endblock %}

{% block content %}
<main>
    <h1>Adminextra Users</h1>
</main>
<section class="adminextra-content">

    {% for user in user_list %}
    <div class="adminextra-content-row">
        <div class="adminextra-content-row-id">
            <a href="{% url 'admin:main_user_change' user.id %}">
                {{ user.id }}
            </a>
        </div>
        <div class="adminextra-content-row-id2">
            {{ user.stripe_customer_id|default:"" }}
        </div>
        <div class="adminextra-content-row-username">
            <span>{{ user.class_status }}</span>
            {% if user.is_approved %}
            <span title="approved">âœ…</span>
            {% endif %}
            <span>
                {{ user.username }}
            </span>

            {% if user.onboard_set.first is not None %}
            <div>
                <ul>
                    <li title="{{ user.onboard_set.first.problems }}">{{ user.onboard_set.first.problems }}</li>
                    <li title="{{ user.onboard_set.first.quality }}">{{ user.onboard_set.first.quality }}</li>
                </ul>
            </div>
            {% endif %}
        </div>
        <div class="adminextra-content-row-actions">
            [
                {% if not user.is_approved %}
                <form method="post" class="form-inline" action="{% url 'adminextra_user_approve' user.id %}">
                    {% csrf_token %}
                    <input type="submit" value="approve" style="color: green;">
                </form>
                | <a style="color: red;" href="{% url 'admin:main_user_delete' user.id %}" target="_blank">delete</a>
                {% else %}
                <form method="post" class="form-inline" action="{% url 'adminextra_user_unapprove' user.id %}">
                    {% csrf_token %}
                    <input type="submit" value="unapprove">
                </form>
                {% endif %}
            ]
        </div>
        <div class="adminextra-content-row-url">
            <a href="{{ user.blog_url }}" target="_blank">
                {{ user.blog_url }}
            </a>
        </div>
        <div class="adminextra-content-row-email">
            {{ user.email }}
        </div>
        <div class="adminextra-content-row-posts">
            <ul>
                {% for post in user.post_set.all %}
                <li>
                    <a href="{{ post.get_absolute_url }}" target="_blank" rel="noopener">
                        {{ post.title }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endfor %}

</section>
{% endblock %}
